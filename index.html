<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Busca de Técnico Responsável</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#000000;
    --card:#0a0a0a;
    --accent:#6ee7b7;
    --muted:#9aa4b2;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{
    margin:0;
    background:linear-gradient(180deg,#000000 0%, #050505 100%);
    color:#e6eef6;
    min-height:100vh;
    padding:28px;
  }
  .wrap{
    max-width:1100px;margin:0 auto;
  }
  header{
    display:flex;align-items:center;gap:18px;margin-bottom:18px;
  }
  header h1{
    margin:0;font-size:20px;font-weight:700;color:var(--accent);
  }
  .search-area{
    display:flex;gap:12px;align-items:center;margin-bottom:18px;
  }
  .search-box{
    flex:1;display:flex;align-items:center;background:var(--glass);padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);
  }
  .search-box input{
    width:100%;background:transparent;border:0;color:#eaf6f0;font-size:16px;outline:none;padding:6px;
  }
  .btn{
    background:linear-gradient(90deg,#10b981,#06b6d4);border:none;color:#062024;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer;
    box-shadow:0 6px 18px rgba(2,6,23,0.6);
  }
  .controls{display:flex;gap:10px;align-items:center;}
  .toggle {
    background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer;
  }

  main{display:grid;grid-template-columns: 1fr 380px;gap:18px;}
  /* results list */
  .results { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03); min-height:400px; }
  .cards{display:grid;grid-template-columns:repeat(1,1fr);gap:10px;}
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);
    display:flex;flex-direction:column;gap:6px;
  }
  .card h3{margin:0;font-size:15px;color:#fff}
  .meta{display:flex;gap:8px;flex-wrap:wrap;color:var(--muted);font-size:13px}
  .highlight{background:linear-gradient(90deg,#ffeeba55,#ffd16655);color:#062024;padding:2px 6px;border-radius:6px;font-weight:600}
  /* side panel */
  .panel{background:var(--card);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);}
  .stats{display:flex;gap:8px;flex-direction:column}
  .stat-row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed rgba(255,255,255,0.02);color:var(--muted)}
  .small{font-size:13px;color:var(--muted)}
  /* table view */
  .table-wrap{overflow:auto;background:transparent;border-radius:8px;margin-top:10px;}
  table{width:100%;border-collapse:collapse;background:transparent}
  th,td{padding:8px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.03);font-size:14px}
  th{color:var(--accent);font-weight:700}
  td{color:#e7f6f0}
  .no-results{padding:24px;text-align:center;color:var(--muted)}
  footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}
  @media(max-width:900px){
    main{grid-template-columns:1fr}
    .panel{order:2}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" style="filter:drop-shadow(0 6px 12px rgba(0,0,0,0.6))">
        <rect x="2" y="3" width="20" height="18" rx="3" fill="#06b6d4"></rect>
        <path d="M7 9h10M7 13h6" stroke="#042028" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <h1>Busca de Técnico Responsável — Direct Internet</h1>
    </header>

    <div class="search-area">
      <div class="search-box" role="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="margin-right:8px;opacity:.9">
          <path d="M21 21l-4.35-4.35" stroke="#dff7ee" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="11" cy="11" r="6.2" stroke="#dff7ee" stroke-width="1.6"/>
        </svg>
        <input id="search" placeholder="Digite qualquer parte da região, bairro ou nome do técnico..." autofocus />
      </div>

      <div class="controls">
        <button class="toggle" id="viewToggle">Ver: Cards</button>
        <button class="btn" id="clearBtn">Limpar</button>
      </div>
    </div>

    <main>
      <section class="results" id="resultsSection">
        <div id="resultsCount" style="margin-bottom:10px;color:var(--muted);font-size:13px">Resultados: <strong id="count">0</strong></div>
        <div id="cardsContainer" class="cards"></div>

        <div id="tableContainer" class="table-wrap" style="display:none;margin-top:12px">
          <table>
            <thead><tr><th>Região</th><th>Bairro</th><th>Técnico Responsável</th></tr></thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>

        <div id="noResults" class="no-results" style="display:none">Nenhum resultado encontrado.</div>
      </section>

      <aside class="panel">
        <div class="stats">
          <div class="stat-row"><div class="small">Regiões totais</div><div id="uniqueRegions" class="small">—</div></div>
          <div class="stat-row"><div class="small">Bairros totais</div><div id="uniqueBairros" class="small">—</div></div>
          <div class="stat-row"><div class="small">Técnicos diferentes</div><div id="uniqueTecnicos" class="small">—</div></div>
        </div>

        <div style="margin-top:12px">
          <label class="small" style="display:block;margin-bottom:6px;color:var(--muted)">Dicas</label>
          <div class="small" style="color:var(--muted);line-height:1.4">
            • Digite parte do nome (ex: "Campo", "Pompeia", "Maikon").<br/>
            • Use "Ver: Tabela" para copiar facilmente resultados.<br/>
            • Registros sem bairro são exibidos com "-" no campo Bairro.

<!-- AVISO IMPORTANTE -->
<div style="
  margin-top:10px;
  padding:10px;
  border-radius:8px;
  background:rgba(255,0,0,0.12);
  border:1px solid rgba(255,0,0,0.35);
  color:#ff4d4d;
  font-weight:700;
  font-size:14px;
">
  ⚠ ATENÇÃO: Verifique sempre se o cliente é migrado de outra empresa!  
</div>

          </div>
        </div>
      </aside>
    </main>

    <footer>
      Gerador de busca • Base carregada localmente
    </footer>
  </div>


<script>
// ---------- DADOS (cole sua lista JSON inteira aqui) ----------
const rawData = [
  {"Região":"São José dos Pinhais","Bairro":"Cotia","Técnico-Responsavel":"Douglas"},
  {"Região":"Campo Largo","Bairro":"São Luiz","Técnico-Responsavel":"Maikon Gurski"},
  {"Região":"Campo Largo","Bairro":"Pompeia","Técnico-Responsavel":"Maikon Gurski"},
  {"Região":"Campo Largo","Bairro":"Cercadinho","Técnico-Responsavel":"Maikon Gurski"},
  {"Região":"Campo Largo","Bairro":"Miqueleto","Técnico-Responsavel":"Maikon Gurski"},
  {"Região":"Almirante Tamandaré","Bairro":"Mato Dentro","Técnico-Responsavel":"Vinicius Cichon"},
  {"Região":"Curitiba","Bairro":"Lamenha Pequena","Técnico-Responsavel":"Pamela Christina"},
  {"Região":"Curitiba","Bairro":"Butiatuvinha","Técnico-Responsavel":"Pamela Christina"},
  {"Região":"Campina Grande do Sul","Bairro":"Araçatuba","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Campina Grande Do Sul","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Cerme","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Colônia Faria","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Eugenia Maria","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Florida","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Graciosa","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Jacob Ceccon","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Nesita","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Nezita","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Paulista","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Palmitalzinho","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Roseira (CGS)","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Timbu Velho","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Volta Grande","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Canguiri","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Palmares","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Guaraituba (CGS)","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Monte Líbano","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Primavera","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Piraquara","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Planta Bosque Centen","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Planta Vera Cruz","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Vila Nova","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Caraguata","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Centro","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Colônia Maria Jose","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim menino de Deus","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Orestes Tha","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Patrícia","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Jardim Sao Pedro","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Nossa Sra. Das Graças","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Quatro Barras","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"São Pedro","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Campina Grande do Sul","Bairro":"Vila Nossa Sra. De Fátima","Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Almirante Tamandaré","Bairro":"Águas Fervidas","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Arruda","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Butiatumirim","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Capivari","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Cercadinho","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Cercadinho","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Osasco","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Roça Grande","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Santa Gema","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"São Gabriel","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Sapopema","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Ahú","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Barreirinha","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Cachoeira","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Barreirinha","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Vila Formosa","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd. Apucarana","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Campina da Arruda","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"São Venancio","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Roma","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"São Jorge","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"VILA GRECIA","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Novo Horizonte","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Vila Prado","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Josiane","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Monte Santo","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Campo Verde","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Paraiso","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Santa Maria","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Botiatuba","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Buenos aires","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd São Carlos","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Silvana","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Gianini","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Lamenha Grande","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Bonfim","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Tanguá","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Abranches","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Taboão","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Jd Tatiana","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Sumidoro","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Restinga seca","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Macieira","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Campina dos pintos","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"itajacuru","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"Colonia Antonio Prado","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Almirante Tamandaré","Bairro":"EMBU","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Santa Cândida","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"São João","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Bacaetava","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Campestre","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Morro Grande","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Pedroso","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Alto maracanã","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Atuba","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Campo Alto","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Centro","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Das Graças","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Fátima","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Guaraituba","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Guarani","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Cristina","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim das Gracas","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Eucaliptos II","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Marambaia","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Monza","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Palmares","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Paloma","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Planalto","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Santa Monica","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Viviane","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Maracanã","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Maria do Rosario","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Mauá","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"monte castelo","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Monza","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Palmital","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Parque dos Lagos","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Planta Bom Jesus","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Planta Palmital","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Rincão","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Rio Verde","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Roseira","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Alto da Cruz II","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Esperança","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Florestal Grajau","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Guaraci","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Luis Baron","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Palmital","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila São José","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Vale Verde","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vila Yara","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Bacaetava","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Alto da Gloria","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Atuba","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Bacacheri","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Bairro Alto","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Boa Vista","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Cabral","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Campo Pequeno","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Capão da Imbuia","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Juvevê","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Tarumã","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Tingui","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Alphaville","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Alphaville Graciosa","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Alto Tarumã","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Atuba","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Centro","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Conj. Res. Inocoop","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Emiliano Perneta","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Graciosa","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Amélia","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Cláudia","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Jardim Pedro Demerco","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Maria Antonieta","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Pineville","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Vargem Grande","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Weissópolis","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Imbuial","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Poço Negro","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Itajacuru","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Colombo","Bairro":"Santa Terezinha","Técnico-Responsavel":"Thiago Kalva"},
  {"Região":"Lapa","Bairro":null,"Técnico-Responsavel":"Carlos William Loures"},
  {"Região":"Fazenda Rio Grande","Bairro":null,"Técnico-Responsavel":"Douglas"},
  {"Região":"Piên","Bairro":null,"Técnico-Responsavel":"Geovan"},
  {"Região":"Tijucas","Bairro":null,"Técnico-Responsavel":"Geovan"},
  {"Região":"Agudos","Bairro":null,"Técnico-Responsavel":"Geovan"},
  {"Região":"Migrados Lyke Net","Bairro":null,"Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campina Grande do Sul","Bairro":null,"Técnico-Responsavel":"Camilla Gaspar"},
  {"Região":"Bocaiuva do Sul","Bairro":null,"Técnico-Responsavel":"Juliano de Jesus Moreira"},
  {"Região":"Rio Branco","Bairro":null,"Técnico-Responsavel":"Vinicius Cichon"},
  {"Região":"Itaperuçu","Bairro":null,"Técnico-Responsavel":"Vinicius Cichon"},
  {"Região":"Tranqueira","Bairro":null,"Técnico-Responsavel":"Vinicius Cichon"},
  {"Região":"Areias","Bairro":null,"Técnico-Responsavel":"Vinicius Cichon"},
  {"Região":"Campo Grande","Bairro":null,"Técnico-Responsavel":"Vinicius Cichon"},
  {"Região":"Mina de Ferro","Bairro":null,"Técnico-Responsavel":"Vinicius Cichon"},
  {"Região":"Campo Magro","Bairro":null,"Técnico-Responsavel":"Pamlea Christina"},
  {"Região":"São José dos Pinhais","Bairro":null,"Técnico-Responsavel":"Weliton"},
  {"Região":"Araucaria - Capela Velha","Bairro":null,"Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Cic","Bairro":null,"Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Tatuquara","Bairro":null,"Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Keli Cristina","Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Vila Gilcy","Técnnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Vila Torres","Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Vila David Antônio","Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Vila Dona Fina","Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Vila Dea","Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Riviera","Técnico-Responsavel":"Jefferson Torres"},
  {"Região":"Campo Largo","Bairro":"Guarany","Técnico-Responsavel":"Pamela Christina"},
  {"Região":"Campo Largo","Bairro":"Vila Dom Pedro II","Técnico-Responsavel":"Pamela Christina"},
  {"Região":"Campo Largo","Bairro":"Bateias","Técnico-Responsavel":"Pamela Christina"},
  {"Região":"Campo Largo","Bairro":"Figueiredo","Técnico-Responsavel":"Pamela Christina"},
{"Região":"Contenda","Bairro":"Campestre","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Migrados Olá Net - São José dos Pinhais","Bairro":"null","Técnico-Responsavel":"Weliton Antunes"},
{"Região":"Lyke Net","Bairro":"Caximba","Técnico-Responsavel":"Douglas"},

{"Região":"Contenda","Bairro":"Campina das Palmeiras","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Campo Thomaz (alguns locais)","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Capinzal","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Capoeira Grande","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Catanduvas","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Costeira","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Feixo","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Itaperubá","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Lagoa Grande","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Lagoão","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Lot. dos Cordeiro","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Loteamento São João","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Mariental","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Mato Dentro","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Passo da Gralha","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Rio do Cacho","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Rincão","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Serrinha","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Thomaz Coelho","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Vl Furmann","Técnico-Responsavel":"André Carlos Batista"},
{"Região":"Contenda","Bairro":"Vl Sossego","Técnico-Responsavel":"André Carlos Batista"},

  {"Região":"Migrados Opta","Bairro":null,"Técnico-Responsavel":"Bruno Mocelin"},
  {"Região":"Migrados Vai Net","Bairro":null,"Técnico-Responsavel":"Gilberto Junior"},
  {"Região":"Migrados Olá Net","Bairro":null,"Técnico-Responsavel":"Gilberto Junior"},
{"Região":"Migrados EG7","Bairro":null,"Técnico-Responsavel":"Gilberto Junior"},
{"Região":"Fazendinha","Bairro":null,"Técnico-Responsavel":"Douglas"},
{"Região":"Migrados Nota10","Bairro":null,"Técnico-Responsavel":"Bruno Mocelin"},

];
// ---------- FIM DOS DADOS ----------

// Normaliza e mapeia chaves (garante consistência)
const data = rawData.map(item => {
  // possible keys variations -> map to standardized keys
  const reg = item['Região'] ?? item['Regiao'] ?? item['regiao'] ?? item['region'] ?? '';
  const bairro = item['Bairro'] ?? item['bairro'] ?? item['Bairros'] ?? null;
  // tecnico may appear as 'Técnico-Responsavel' or 'Técnico-Responsavel' or 'Técnico-Responsavel' variations
  const tecnico = item['Técnico-Responsavel'] ?? item['Técnico-Responsável'] ?? item['Técnico Responsavel'] ?? item['Tecnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico'] ?? item['TécnicoResponsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? item['Técnico-Responsavel'] ?? '';
  // fallback: try to read any key that contains 'tec' or 'técn'
  let tecnicoFinal = tecnico;
  if(!tecnicoFinal){
    for(const k of Object.keys(item)){
      if(/tec|t[eé]cnico|responsavel|responsável/i.test(k) && item[k]) { tecnicoFinal = item[k]; break; }
    }
  }
  return { region: String(reg).trim(), bairro: bairro === null ? null : String(bairro).trim(), tecnico: String(tecnicoFinal).trim() };
});

// Elements
const searchInput = document.getElementById('search');
const cardsContainer = document.getElementById('cardsContainer');
const tableBody = document.getElementById('tableBody');
const noResultsEl = document.getElementById('noResults');
const countEl = document.getElementById('count');
const uniqueRegionsEl = document.getElementById('uniqueRegions');
const uniqueBairrosEl = document.getElementById('uniqueBairros');
const uniqueTecnicosEl = document.getElementById('uniqueTecnicos');
const viewToggle = document.getElementById('viewToggle');
const tableContainer = document.getElementById('tableContainer');
const clearBtn = document.getElementById('clearBtn');

let showTable = false;

// Stats
function updateStats(){
  const regions = new Set(data.filter(d=>d.region).map(d=>d.region));
  const bairros = new Set(data.filter(d=>d.bairro).map(d=>d.bairro));
  const tecnicos = new Set(data.filter(d=>d.tecnico).map(d=>d.tecnico));
  uniqueRegionsEl.textContent = regions.size;
  uniqueBairrosEl.textContent = bairros.size;
  uniqueTecnicosEl.textContent = tecnicos.size;
}
updateStats();

// highlight helper
function highlight(text, q){
  if(!q) return escapeHtml(text || '');
  const t = (text||'').toString();
  const qi = q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  const re = new RegExp('('+qi+')','ig');
  return escapeHtml(t).replace(re, '<span class="highlight">$1</span>');
}
function escapeHtml(s){ return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

// render functions
function renderCards(items, q){
  cardsContainer.innerHTML = '';
  if(items.length===0){
    noResultsEl.style.display='block';
    return;
  }
  noResultsEl.style.display='none';
  items.forEach(it=>{
    const card = document.createElement('div');
    card.className = 'card';
    const regionHtml = highlight(it.region || '-', q);
    const bairroHtml = highlight(it.bairro || '-', q);
    const tecnicoHtml = highlight(it.tecnico || '-', q);
    card.innerHTML = `<h3>${tecnicoHtml}</h3>
      <div class="meta"><div>Região: ${regionHtml}</div><div>Bairro: ${bairroHtml}</div></div>`;
    cardsContainer.appendChild(card);
  });
}

function renderTable(items){
  tableBody.innerHTML = '';
  if(items.length===0){ noResultsEl.style.display='block'; return; }
  noResultsEl.style.display='none';
  for(const it of items){
    const tr = document.createElement('tr');
    const r = escapeHtml(it.region || '-');
    const b = escapeHtml(it.bairro || '-');
    const t = escapeHtml(it.tecnico || '-');
    tr.innerHTML = `<td>${r}</td><td>${b}</td><td>${t}</td>`;
    tableBody.appendChild(tr);
  }
}

// search
function performSearch(){
  const q = searchInput.value.trim().toLowerCase();
  // if empty, show all
  let results = data.filter(d=>{
    if(!q) return true;
    const matchesRegion = d.region && d.region.toLowerCase().includes(q);
    const matchesBairro = d.bairro && d.bairro.toLowerCase().includes(q);
    const matchesTec = d.tecnico && d.tecnico.toLowerCase().includes(q);
    return matchesRegion || matchesBairro || matchesTec;
  });

  countEl.textContent = results.length;

  // default view: cards
  if(showTable){
    tableContainer.style.display='block';
    renderTable(results);
  } else {
    tableContainer.style.display='none';
    renderCards(results, q);
  }
}

// events
searchInput.addEventListener('input', performSearch);
viewToggle.addEventListener('click', ()=>{
  showTable = !showTable;
  viewToggle.textContent = showTable ? 'Ver: Tabela' : 'Ver: Cards';
  // toggle text is inverted intentionally to reflect action (you can change)
  performSearch();
});
clearBtn.addEventListener('click', ()=>{
  searchInput.value='';
  performSearch();
});

// initial render
performSearch();

</script>
</body>
</html>
